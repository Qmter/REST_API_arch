==================================================
Сценарий успешно загружен!
{
  "/interfaces/tunnel/multicast": {
    "TESTS": {
      "1": {
        "description": "Set on multicast",
        "steps": {
          "1": {
            "endpoint": "/interfaces/tunnel/add",
            "method": "POST",
            "parameters": {
              "ifname": "random",
              "source": "random"
            },
            "expected": {
              "errCode": 0,
              "httpCode": 200
            }
          },
          "2": {
            "endpoint": "/interfaces/tunnel/multicast",
            "method": "POST",
            "parameters": {
              "ifname": {
                "ref": "#TESTS/1/steps.1.parameters.ifname"
              },
              "action": "on"
            },
            "expected": {
              "errCode": 0,
              "httpCode": 200
            }
          },
          "3": {
            "endpoint": "/interfaces/tunnel/capability",
            "method": "GET",
            "parameters": {
              "ifname": {
                "ref": "#TESTS.1.steps.1.parameters.ifname"
              }
            },
            "validation": {
              "ifname": {
                "ref": "#TESTS.1.steps.1.parameters.ifname"
              },
              "source": {
                "ref": "#TESTS.1.steps.1.parameters.source"
              },
              "multicast": "on"
            },
            "expected": {
              "errCode": 0,
              "httpCode": 200
            }
          }
        }
      },
      "2": {
        "description": "Set off multicast",
        "steps": {
          "1": {
            "endpoint": "/interfaces/tunnel/add",
            "method": "POST",
            "parameters": {
              "ifname": "random",
              "source": "random"
            },
            "expected": {
              "errCode": 0,
              "httpCode": 200
            }
          },
          "2": {
            "endpoint": "/interfaces/tunnel/multicast",
            "method": "POST",
            "parameters": {
              "ifname": {
                "ref": "#TESTS.2.steps.1.parameters.ifname"
              },
              "action": "off"
            },
            "expected": {
              "errCode": 0,
              "httpCode": 200
            }
          },
          "3": {
            "endpoint": "/interfaces/tunnel/capability",
            "method": "GET",
            "parameters": {
              "ifname": {
                "ref": "#TESTS.2.steps.1.parameters.ifname"
              }
            },
            "validation": {
              "ifname": {
                "ref": "#TESTS.2.steps.1.parameters.ifname"
              },
              "source": {
                "ref": "#TESTS.2.steps.1.parameters.source"
              },
              "multicast": "off"
            },
            "expected": {
              "errCode": 0,
              "httpCode": 200
            }
          }
        }
      }
    },
    "AFTER-TEST": {
      "steps": {
        "1": {
          "endpoint": "/interfaces/tunnel/delete",
          "method": "POST",
          "parameters": {
            "ifname": {
              "ref": "#TESTS.1.steps.1.parameters.ifname"
            }
          },
          "expected": {
            "errCode": 0,
            "httpCode": 200
          }
        },
        "2": {
          "endpoint": "/interfaces/tunnel/delete",
          "method": "POST",
          "parameters": {
            "ifname": {
              "ref": "#TESTS.2.steps.1.parameters.ifname"
            }
          },
          "expected": {
            "errCode": 0,
            "httpCode": 200
          }
        }
      }
    }
  }
}
==================================================
==================================================
Все ендпоинты, присутствующие в сценирии:
{'/interfaces/tunnel/multicast': 'POST', '/interfaces/tunnel/add': 'POST', '/interfaces/tunnel/capability': 'GET', '/interfaces/tunnel/delete': 'POST'}
==================================================
==================================================
Разрешены ссылки для ендпоинтов:
{
  "/interfaces/tunnel/multicast": {
    "tags": [
      "interfaces/tunnel"
    ],
    "summary": "Turn multicast on/off",
    "description": "Turn multicast on/off for a tunnel. Multicast is turned `off` by default.\n\nCLI commands: `[no] ip multicast`",
    "requestBody": {
      "required": true,
      "content": {
        "application/json": {
          "schema": {
            "required": [
              "ifname",
              "action"
            ],
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "ifname": {
                "description": "Tunnel interface name",
                "type": "string",
                "pattern": "^tunnel(0|[1-9][0-9]{0,3})$"
              },
              "action": {
                "type": "string",
                "enum": [
                  "on",
                  "off"
                ],
                "description": "on|off"
              }
            }
          }
        }
      }
    },
    "responses": {
      "200": {
        "description": "Multicast set successfully",
        "content": {
          "application/json": {
            "schema": {
              "title": "generic output PDUs",
              "description": "JSON format of response PDU for the communication between web backend and mprdaemon. Objects cannot contain properties other than ['errCode', 'result', 'request']",
              "required": [
                "errCode",
                "result",
                "request"
              ],
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "errCode": {
                  "title": "error code",
                  "description": "error code of operation, nonzero means error, string describes details of error",
                  "type": "array",
                  "prefixItems": [
                    {
                      "type": "integer"
                    },
                    {
                      "type": [
                        "string",
                        "null"
                      ]
                    }
                  ],
                  "maxItems": 2,
                  "minItems": 2
                },
                "result": {},
                "request": {}
              }
            }
          }
        }
      }
    }
  },
  "/interfaces/tunnel/add": {
    "tags": [
      "interfaces/tunnel"
    ],
    "summary": "Add tunnel interface",
    "description": "Add tunnel interface\n\nCLI commands: `interface tunnel`, `tunnel source ... [destination] ...`",
    "requestBody": {
      "required": true,
      "content": {
        "application/json": {
          "schema": {
            "description": "Add tunnel interface",
            "additionalProperties": false,
            "required": [
              "ifname",
              "settings"
            ],
            "type": "object",
            "properties": {
              "ifname": {
                "description": "Tunnel interface name",
                "type": "string",
                "pattern": "^tunnel(0|[1-9][0-9]{0,3})$"
              },
              "vrf_name": {
                "type": "string",
                "pattern": "^[A-Za-z0-9_-]{1,12}$",
                "description": "VRF NAME (Only letters and numbers, 12 characters max)"
              },
              "settings": {
                "type": "object",
                "description": "Settings needed for tunnel creation",
                "properties": {
                  "mode": {
                    "description": "Tunnel mode. `gre` by default if omitted",
                    "type": "string",
                    "enum": [
                      "gre",
                      "ipip",
                      "gretap",
                      "vti"
                    ]
                  },
                  "source": {
                    "description": "Source for a tunnel. Either ip address or a local interface name.",
                    "anyOf": [
                      {
                        "type": "string",
                        "pattern": "^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$",
                        "description": "A.B.C.D"
                      },
                      {
                        "type": "string",
                        "pattern": "^((eth(0|[1-9][0-9]{0,3})\\.(0|[1-9][0-9]{0,3}))|(vlan([0-9]|[1-9][0-9]{1,2}|[1-3][0-9]{3}|40[0-8][0-9]|409[0-5]))|([A-Za-uw-z][A-Za-z0-9_\\-]{0,30}[A-Za-z](0|[1-9][0-9]{0,3})))$",
                        "description": "IFNAME"
                      }
                    ]
                  },
                  "dst_address": {
                    "type": "string",
                    "pattern": "^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$",
                    "description": "A.B.C.D"
                  },
                  "key": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 4294967295,
                    "description": "<1-4294967295>"
                  },
                  "tos": {
                    "oneOf": [
                      {
                        "type": "string",
                        "const": "inherit"
                      },
                      {
                        "type": "integer",
                        "minimum": 2,
                        "maximum": 255,
                        "description": "<2-255>"
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      }
    },
    "responses": {
      "200": {
        "description": "Interface added successfully",
        "content": {
          "application/json": {
            "schema": {
              "title": "generic output PDUs",
              "description": "JSON format of response PDU for the communication between web backend and mprdaemon. Objects cannot contain properties other than ['errCode', 'result', 'request']",
              "required": [
                "errCode",
                "result",
                "request"
              ],
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "errCode": {
                  "title": "error code",
                  "description": "error code of operation, nonzero means error, string describes details of error",
                  "type": "array",
                  "prefixItems": [
                    {
                      "type": "integer"
                    },
                    {
                      "type": [
                        "string",
                        "null"
                      ]
                    }
                  ],
                  "maxItems": 2,
                  "minItems": 2
                },
                "result": {},
                "request": {}
              }
            }
          }
        }
      }
    }
  },
  "/interfaces/tunnel/capability": {
    "tags": [
      "interfaces/tunnel"
    ],
    "summary": "Get tunnel capabilities",
    "description": "Get tunnel capabilities (unique properties of tunnel interfaces)\n\nCLI commands: part of `show interfaces tunnel`",
    "parameters": [
      {
        "name": "ifname",
        "description": "tunnel name",
        "in": "query",
        "required": true,
        "schema": {
          "description": "Tunnel interface name",
          "type": "string",
          "pattern": "^tunnel(0|[1-9][0-9]{0,3})$"
        }
      }
    ],
    "responses": {
      "200": {
        "description": "Successfully read",
        "content": {
          "application/json": {
            "schema": {
              "title": "generic output PDUs",
              "description": "JSON format of response PDU for the communication between web backend and mprdaemon. Objects cannot contain properties other than ['errCode', 'result', 'request']",
              "required": [
                "errCode",
                "result",
                "request"
              ],
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "errCode": {
                  "title": "error code",
                  "description": "error code of operation, nonzero means error, string describes details of error",
                  "type": "array",
                  "prefixItems": [
                    {
                      "type": "integer"
                    },
                    {
                      "type": [
                        "string",
                        "null"
                      ]
                    }
                  ],
                  "maxItems": 2,
                  "minItems": 2
                },
                "result": {},
                "request": {}
              }
            }
          }
        }
      }
    }
  },
  "/interfaces/tunnel/delete": {
    "tags": [
      "interfaces/tunnel"
    ],
    "summary": "Delete tunnel interface",
    "description": "Delete tunnel interface\n\nCLI command: `no interface tunnel`",
    "requestBody": {
      "required": true,
      "content": {
        "application/json": {
          "schema": {
            "description": "Delete tunnel interface",
            "required": [
              "ifname"
            ],
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "ifname": {
                "description": "Tunnel interface name",
                "type": "string",
                "pattern": "^tunnel(0|[1-9][0-9]{0,3})$"
              }
            }
          }
        }
      }
    },
    "responses": {
      "200": {
        "description": "Interface deleted successfully",
        "content": {
          "application/json": {
            "schema": {
              "title": "generic output PDUs",
              "description": "JSON format of response PDU for the communication between web backend and mprdaemon. Objects cannot contain properties other than ['errCode', 'result', 'request']",
              "required": [
                "errCode",
                "result",
                "request"
              ],
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "errCode": {
                  "title": "error code",
                  "description": "error code of operation, nonzero means error, string describes details of error",
                  "type": "array",
                  "prefixItems": [
                    {
                      "type": "integer"
                    },
                    {
                      "type": [
                        "string",
                        "null"
                      ]
                    }
                  ],
                  "maxItems": 2,
                  "minItems": 2
                },
                "result": {},
                "request": {}
              }
            }
          }
        }
      }
    }
  }
}
==================================================
==================================================
Аргументы ендпоинта и его паттерны:
==================================================
{
  "/interfaces/tunnel/multicast": {
    "ifname": {
      "pattern": "^tunnel(0|[1-9][0-9]{0,3})$"
    }
  },
  "/interfaces/tunnel/add": {
    "ifname": {
      "pattern": "^tunnel(0|[1-9][0-9]{0,3})$"
    },
    "vrf_name": {
      "pattern": "^[A-Za-z0-9_-]{1,12}$"
    },
    "source": {
      "pattern": "^((eth(0|[1-9][0-9]{0,3})\\.(0|[1-9][0-9]{0,3}))|(vlan([0-9]|[1-9][0-9]{1,2}|[1-3][0-9]{3}|40[0-8][0-9]|409[0-5]))|([A-Za-uw-z][A-Za-z0-9_\\-]{0,30}[A-Za-z](0|[1-9][0-9]{0,3})))$"
    },
    "dst_address": {
      "pattern": "^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$"
    },
    "key": {
      "minimum": 1,
      "maximum": 4294967295
    },
    "tos": {
      "minimum": 2,
      "maximum": 255
    }
  },
  "/interfaces/tunnel/capability": {
    "ifname": {
      "pattern": "^tunnel(0|[1-9][0-9]{0,3})$"
    }
  },
  "/interfaces/tunnel/delete": {
    "ifname": {
      "pattern": "^tunnel(0|[1-9][0-9]{0,3})$"
    }
  }
}
